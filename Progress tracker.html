<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="utf-8" />
    <title>Bog Bingo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <style>
        :root { --accent:#7c4dff; }
        body { background:#f8f9fa; }
        .card { border:0; border-radius:1rem; box-shadow:0 10px 25px rgba(0,0,0,.08); }
        .progress { height: .75rem; }

        .bingo-grid { display:grid; grid-template-columns:repeat(5,1fr); gap:.5rem; }
        @media (max-width:768px){ .bingo-grid { grid-template-columns:repeat(3,1fr);} }

        .bingo-cell{ position:relative; background:#fff; border:1px solid #e9ecef; border-radius:.75rem; padding:.85rem; cursor:pointer; user-select:none; transition:background .2s, border-color .2s; }
        .bingo-cell:hover{ background:#f1f3f5; }
        .bingo-cell .label-text{ display:block; text-align:left; padding-right:.5rem; }

        .bingo-cell.completed{ border-color:var(--accent); background:#f3efff; }
        .bingo-cell.completed .label-text{ text-decoration:line-through; opacity:.75; }

        @media (prefers-reduced-motion: reduce){ .bingo-cell{ transition:none; } }
    </style>
</head>
<body class="bg-light d-flex flex-column align-items-center min-vh-100">
<div class="container my-4">
    <header class="text-center mb-4">
        <h1 class="fw-bold mb-1">Bogbingo – Progress Tracker</h1>
        <p class="text-muted mb-0">Klik på et felt for at markere det. Ingen flueben – kun tekst gennemstregning.</p>
    </header>

    <div class="card">
        <div class="card-body p-3 p-md-4">
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-2 mb-3">
                <div class="fw-semibold">Status: <span id="checkedCount">0</span>/<span id="totalCount">25</span></div>
                <div class="d-flex align-items-center gap-2 w-100 w-md-50">
                    <div class="flex-grow-1">
                        <div class="progress" role="progressbar" aria-label="Fremskridt" aria-valuemin="0" aria-valuemax="100">
                            <div id="progressBar" class="progress-bar" style="width:0%"></div>
                        </div>
                    </div>
                    <div style="min-width:3ch"><span id="progressPct">0</span>%</div>
                </div>
            </div>

            <div id="bingoGrid" class="bingo-grid" aria-live="polite"></div>

            <div class="d-flex gap-2 mt-4">
                <button id="resetBtn" class="btn btn-outline-secondary">Nulstil</button>
                <button id="shareBtn" class="btn btn-primary">Del fremskridt</button>
            </div>
        </div>
    </div>

    <footer class="text-center text-muted mt-4 small">Bootstrap 5.3 · Simpelt og let at udvide</footer>
</div>

<script>
    // 25 felter — uden "FRI FELT"
    const EXAMPLE_TASKS = [
        'Læs en bog under 200 sider','En bog af en debutforfatter','En prisvindende roman','En bog i en serie','En bog fra din barndom',
        'En bog sat i et andet land','En non-fiction','En bog udgivet i år','En grafisk roman/tegneserie','En dystopi',
        'En krimi/thriller','En klassiker','En bog anbefalet af en ven','En bog med et farvenavn i titlen','En bog om natur',
        'En bog af en dansk forfatter','En bog oversat til dansk','En lydbog','En bog med dyr på forsiden','En bog udgivet før 2000',
        'En fantasy','En sci‑fi','En selvhjælpsbog','En novellesamling','En bog du normalt ikke ville vælge'
    ];

    const grid = document.getElementById('bingoGrid');
    const totalCountEl = document.getElementById('totalCount');
    const checkedCountEl = document.getElementById('checkedCount');
    const progressBar = document.getElementById('progressBar');
    const progressPctEl = document.getElementById('progressPct');
    const resetBtn = document.getElementById('resetBtn');
    const shareBtn = document.getElementById('shareBtn');

    let tasks = [];

    const loadTasks = () => {
        const saved = localStorage.getItem('bogbingo_tasks_simple');
        if (saved) {
            try { tasks = JSON.parse(saved); } catch { tasks = []; }
        }
        // Hvis gamle data indeholder "FRI FELT", fjern det og erstat med nyt felt
        if (tasks?.length) {
            tasks = tasks.filter(t => !String(t.text).toUpperCase().includes('FRI FELT'));
        }
        if (!tasks.length) {
            tasks = EXAMPLE_TASKS.map((t,i)=>({ id:i+1, text:t, done:false }));
        } else if (tasks.length < 25) {
            // Fyld op til 25, hvis der mangler efter oprydning
            const missing = EXAMPLE_TASKS.filter(x => !tasks.some(t => t.text === x))
                .slice(0, 25 - tasks.length)
                .map((t,i)=>({ id: tasks.length + i + 1, text:t, done:false }));
            tasks = tasks.concat(missing);
        } else if (tasks.length > 25) {
            tasks = tasks.slice(0,25);
        }
        saveTasks();
    };

    const saveTasks = () => localStorage.setItem('bogbingo_tasks_simple', JSON.stringify(tasks));

    const updateProgress = () => {
        const total = tasks.length || 1;
        const done = tasks.filter(t=>t.done).length;
        const pct = Math.round((done/total)*100);
        totalCountEl.textContent = total;
        checkedCountEl.textContent = done;
        progressBar.style.width = pct+"%";
        progressBar.setAttribute('aria-valuenow', pct);
        progressPctEl.textContent = pct;
    };

    const toggleTask = (task, cell) => {
        task.done = !task.done;
        cell.classList.toggle('completed', task.done);
        saveTasks();
        updateProgress();
    };

    const renderGrid = () => {
        grid.innerHTML = '';
        tasks.forEach(task => {
            const cell = document.createElement('div');
            cell.className = 'bingo-cell'+(task.done?' completed':'');
            cell.setAttribute('role','button');
            cell.setAttribute('tabindex','0');
            cell.setAttribute('aria-pressed', task.done);

            const text = document.createElement('span');
            text.className = 'label-text';
            text.textContent = task.text;
            cell.appendChild(text);

            cell.addEventListener('click', ()=>{ toggleTask(task, cell); cell.setAttribute('aria-pressed', task.done); });
            cell.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); toggleTask(task, cell); cell.setAttribute('aria-pressed', task.done);} });

            grid.appendChild(cell);
        });
    };

    const resetAll = () => {
        tasks = tasks.map(t=>({...t, done:false}));
        saveTasks(); renderGrid(); updateProgress();
    };

    const shareProgress = () => {
        const total = tasks.length || 1;
        const done = tasks.filter(t=>t.done).length;
        const pct = Math.round((done/total)*100);
        const text = `Min Bogbingo-status: ${done}/${total} (${pct}%).`;
        if(navigator.share){ navigator.share({title:'Bogbingo', text}); }
        else { navigator.clipboard.writeText(text).then(()=>alert('Status kopieret til udklipsholder!')); }
    };

    loadTasks();
    renderGrid();
    updateProgress();
    resetBtn.addEventListener('click', resetAll);
    shareBtn.addEventListener('click', shareProgress);
</script>
</body>
</html>
